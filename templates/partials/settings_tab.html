<div class="container py-3" id="settings-tab">
  <h5>Settings</h5>

  <!-- Local build info -->
  <div class="card mb-3 shadow-sm">
    <div class="card-body">
      <h6 class="card-title d-flex align-items-center justify-content-between">
        <span id="vm-tap-area">Current Build</span>
        <span id="vm-build-tag"></span>
      </h6>
      <table class="table table-sm mb-0">
        <tbody id="vm-local-info">
          <tr>
            <td colspan="2"><em>Loading...</em></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="settings-section" id="vm-admin-section">
    <!-- Remote commits -->
    <div id="vm-admin-card" class="card mb-3 shadow-sm">
      <div class="card-body">

        <!-- Header -->
        <h6 class="card-title mb-2">Available Commits (GitHub)</h6>

        <!-- Commit selector + "Show all commits" button in one row -->
        <div class="vm-commit-row mb-3">
          <select id="vm-commit-select" class="form-select form-select-sm">
            <option value="">Loading...</option>
          </select>
          <button id="vm-toggle-stable-btn" class="btn btn-outline-secondary btn-sm flex-shrink-0"
            onclick="vm_toggleStable()">
            Show all commits
          </button>
        </div>

        <!-- Action buttons -->
        <div class="d-flex flex-wrap gap-2 mb-2">
          <button id="vm-checkout-btn" class="btn btn-primary btn-sm flex-fill flex-sm-grow-0">
            Switch to this version
          </button>
          <button id="vm-rollback-btn" class="btn btn-outline-secondary btn-sm flex-fill flex-sm-grow-0">
            Rollback
          </button>
        </div>

        <!-- Status output -->
        <div id="vm-status" class="small text-muted mb-1"></div>

        <!-- Last updated + Force Refresh -->
        <div class="d-flex justify-content-between align-items-center flex-wrap mb-2">
          <div id="vm-last-update" class="small text-secondary fst-italic">
            üïì Last updated: not yet
          </div>
          <button id="vm-refresh-btn" class="btn btn-outline-secondary btn-sm mt-2 mt-sm-0"
            title="Force reload from GitHub (60 requests/hr limit)">
            <span id="vm-refresh-icon">üîÑ</span>
            <span id="vm-spinner" class="spinner-border spinner-border-sm ms-1 d-none" role="status"
              aria-hidden="true"></span>
            Force Refresh
          </button>
        </div>

        <!-- Gentle warning -->
        <small id="vm-warning" class="text-muted fst-italic d-block">
          ‚ö†Ô∏è Frequent refreshes may hit GitHub‚Äôs hourly API limit (60 unauthenticated requests).
        </small>

      </div>
    </div>

    <div class="card mb-3">
      <div class="card-header">System Services</div>
      <div class="card-body">
        <div class="form-check form-switch mb-2">
          <input class="form-check-input" type="checkbox" id="simulatorToggle">
          <label class="form-check-label" for="simulatorToggle">Use Simulator on Restart</label>
        </div>
        <button id="btnRestartService" class="btn btn-primary">Restart Gasera Service</button>
      </div>
    </div>

  </div>

  <div class="card mb-3">
    <div class="card-header">WiFi Manager</div>
    <div class="card-body">
      <!-- Status header (filled by JS) -->
      <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-2">
        <div>
          <div class="fw-semibold" id="wifiConnTitle">WiFi</div>
          <div class="small text-muted" id="wifiConnSub">Not scanned yet</div>
        </div>
        <div class="d-flex align-items-center gap-2">
          <button id="btnScanWifi" class="btn btn-outline-primary btn-sm">Scan</button>
          <div class="form-check form-switch m-0">
            <input class="form-check-input" type="checkbox" id="wifiShowWeak">
            <label class="form-check-label small" for="wifiShowWeak">Show unavailable</label>
          </div>
        </div>
      </div>

      <!-- Unified network list -->
      <ul id="wifiNetworks" class="list-group"></ul>

      <!-- Footer controls -->
      <div class="d-flex justify-content-between align-items-center mt-2">
        <div id="wifiStatus" class="small text-muted"></div>
        <button id="wifiShowMore" class="btn btn-outline-secondary btn-sm d-none">Show more</button>
      </div>
    </div>
  </div>

  <div class="card mb-3" id="motion_control_card">
    <div class="card-header">Motion Manual Control</div>
    <div class="card-body">

      <div class="row g-3">
        <!-- Channel 0 -->
        <div id="motion-unit-0" class="col-md-4">
          <div class="card shadow-sm motion-card">
            <div class="card-body">
              <div class="card-title">Channel 0</div>

              <div class="d-grid gap-2">
                <button class="btn btn-primary motion-btn" onmousedown="motionStep('0')" onmouseup="motionReset('0')">
                  <i class="bi bi-arrow-right-circle"></i>
                  Step
                </button>

                <button class="btn btn-outline-primary motion-btn" onmousedown="motionHome('0')"
                  onmouseup="motionReset('0')">
                  <i class="bi bi-house"></i>
                  Home
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Channel 1 -->
        <div id="motion-unit-1" class="col-md-4">
          <div class="card shadow-sm motion-card">
            <div class="card-body">
              <div class="card-title">Channel 1</div>

              <div class="d-grid gap-2">
                <button class="btn btn-primary motion-btn" onmousedown="motionStep('1')" onmouseup="motionReset('1')">
                  <i class="bi bi-arrow-right-circle"></i>
                  Step
                </button>

                <button class="btn btn-outline-primary motion-btn" onmousedown="motionHome('1')"
                  onmouseup="motionReset('1')">
                  <i class="bi bi-house"></i>
                  Home
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Both Channels -->
        <div id="motion-unit-both" class="col-md-4">
          <div class="card shadow-sm motion-card secondary">
            <div class="card-body">
              <div class="card-title">Both Channels</div>

              <div class="d-grid gap-2">
                <button class="btn btn-primary motion-btn" onmousedown="motionStep('both')"
                  onmouseup="motionReset('both')">
                  <i class="bi bi-arrow-right-circle"></i>
                  Step
                </button>

                <button class="btn btn-outline-primary motion-btn" onmousedown="motionHome('both')"
                  onmouseup="motionReset('both')">
                  <i class="bi bi-house"></i>
                  Home
                </button>
              </div>
            </div>
          </div>
        </div>

        <small class="text-muted">
          Hold to move ¬∑ Release to stop
        </small>

      </div>
    </div>

    <div class="card mb-3">
      <div class="card-header">Device Power</div>
      <div class="card-body">
        <button id="btnDeviceRestart" class="btn btn-warning me-2">Restart Device</button>
        <button id="btnDeviceShutdown" class="btn btn-danger">Shutdown Device</button>
      </div>
    </div>

  </div>